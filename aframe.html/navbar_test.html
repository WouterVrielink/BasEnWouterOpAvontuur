<!DOCTYPE html>
<html>
<head>
  <title>Aframe</title>
  <script src="../aframe/aframe.min.js"></script>
  <script src='../three/js/libs/inflate.min.js'></script>
  <script src="../three/build/three.js"></script>
  <script src="../three/js/controls/TrackballControls.js"></script>
  <script src="../three/js/loaders/VTKLoader.js"></script>
  <script src="../three/js/Detector.js"></script>
  <script src="../three/js/libs/stats.min.js"></script>  <meta charset="utf-8">
  <script src="../aframe/aframe-ar.js"></script>
  <script src="../js/jquery.min.js"></script>
  <script src="https://d3js.org/d3.v4.js"></script>
  <script type="text/javascript">d4 = d3</script>
  <script src="../js/d3.v3.min.js" charset="utf-8"></script>
  <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">

  <link rel="stylesheet" href="../bootstrap/css/bootstrap.min.css">
  <script src="../bootstrap/js/jquery-3.2.1.slim.min.js"></script>
  <script src="../bootstrap/js/popper.min.js"></script>
  <script src="../bootstrap/js/bootstrap.min.js"></script>

<style>
#a-scene {
  position: absolute;
}
#canvas {
  position: absolute;
  background-color:lightgrey
}
#button {
  position:absolute;
  left:0%;
  top:0%;
  z-index: 1;
}

.navbarrie {
  position:absolute;
  background-color: rgba(0,0,0,0.5);
  top:0%;
  z-index: 1;
}
.navbar-brand {
  color: rgba(255, 255, 255, 0.9) !important;
}
.dropdown-menu {
  background-color: rgba(0,0,0,0);
  color: rgba(255, 255, 255, 0.9) !important;
  border: 0px solid rgba(0,0,0,0.5);
  padding: 0;
}
.navbar {
  color:white;
}

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

.axis text {
  font: 10px sans-serif;
}

#s .tick:last-of-type text,
#l .tick:last-of-type text {
  display: none;
}

.channel canvas {
  float: left;
  margin: 40px 30px 0 30px;
  width: 900px;
  height: 90px;

</style>
</head>
<body>
<div class="col-md-12 navbarrie">
<nav class="navbar navbar-toggleable-md navbar-dark bg-faded">
  <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <a class="navbar-brand" href="#">Pierre</a>
  <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
    <div class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" onmouseover="" style="cursor: pointer;" onclick="backToDefault()">Default</a>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" onmouseover="" style="cursor: pointer;">
          BodyParts
        </a>
        <div class="dropdown-menu col-md-6" aria-labelledby="navbarDropdownMenuLink">
          <table class="table">
            <tbody>
              <tr>
                <td data-toggle="dropdown" data-target=".coloring" onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('Skin')">Skin</td>
                <td data-toggle="dropdown" data-target=".coloring" onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('Blood')">Blood</td>
                <td data-toggle="dropdown" data-target=".coloring" onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('Brain')">Brain</td>
                <td data-toggle="dropdown" data-target=".coloring" onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('Duodenum')">Duodenum</td>
              </tr>
              <tr>
                <td data-toggle="dropdown" data-target=".coloring" onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('EyeRetina')">Eye Retina</td>
                <td data-toggle="dropdown" data-target=".coloring" onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('EyeWhite')">Eye White</td>
                <td data-toggle="dropdown" data-target=".coloring" onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('Heart')">Heart</td>
                <td data-toggle="dropdown" data-target=".coloring" onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('Ileum')">Ileum</td>
              </tr>
              <tr>
                <td data-toggle="dropdown" data-target=".coloring" onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('Kidney')">Kidney</td>
                <td data-toggle="dropdown" data-target=".coloring" onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('LargeIntestine')">Large Intestine</td>
                <td data-toggle="dropdown" data-target=".coloring" onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('Liver')">Liver</td>
                <td data-toggle="dropdown" data-target=".coloring" onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('Lung')">Lung</td>
              </tr>
              <tr>
                <td data-toggle="dropdown" data-target=".coloring" onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('Nerve')">Nerve</td>
                <td data-toggle="dropdown" data-target=".coloring" onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('Skeleton')">Skeleton</td>
                <td data-toggle="dropdown" data-target=".coloring" onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('Spleen')">Spleen</td>
                <td data-toggle="dropdown" data-target=".coloring" onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('Stomach')">Stomach</td>
              </tr>
            </tbody>
          </table>
        </div>
      </li>
      <li class="nav-item dropdown coloring">
        <a class="nav-link dropdown-toggle clickable" id="navbarDropdownMenuLink_color" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" onmouseover="" style="cursor: pointer;">
          Coloring
        </a>
        <div class="dropdown-menu col-md-6" aria-labelledby="navbarDropdownMenuLink_color">
          <div class="channel" id="h">
            <canvas width="900" height="1"></canvas>
            <svg width="960" height="20"><g class="axis" transform="translate(30,.5)"></g></svg>
          </div>
          <div class="channel" id="s">
            <canvas width="900" height="1"></canvas>
            <svg width="960" height="20"><g class="axis" transform="translate(30,.5)"></g></svg>
          </div>
          <div class="channel" id="l">
            <canvas width="900" height="1"></canvas>
            <svg width="960" height="20"><g class="axis" transform="translate(30,.5)"></g></svg>
          </div>
          <div width="900" height="40" id="plop" style="background-color: lightblue;">dingen</div>
        </div>
      </li>
    </div>
  </div>
  </nav>
  </div>
<script>

function ChangeStuff(organ) {
  console.log(organ)
  d4.select(".dropdown-menu").dispatch('click');
}

$('li.coloring').on('click', function(event){
    var events = $._data(document, 'events') || {};
    events = events.click || [];
    for(var i = 0; i < events.length; i++) {
        if(events[i].selector) {

            //Check if the clicked element matches the event selector
            if($(event.target).is(events[i].selector)) {
                events[i].handler.call(event.target, event);
            }

            // Check if any of the clicked element parents matches the 
            // delegated event selector (Emulating propagation)
            $(event.target).parents(events[i].selector).each(function(){
                events[i].handler.call(this, event);
            });
        }
    }
    event.stopPropagation(); //Always stop propagation
});

var white = d3.rgb("white"),
    black = d3.rgb("black"),
    width = d3.select("canvas").property("width");

var channels = {
  h: {scale: d3.scale.linear().domain([0, 360]).range([0, width]), x: width / 2},
  s: {scale: d3.scale.linear().domain([0, 1]).range([0, width]), x: width / 2},
  l: {scale: d3.scale.linear().domain([0, 1]).range([0, width]), x: width / 2}
};

var channel = d3.selectAll(".channel")
    .data(d3.entries(channels));

channel.select(".axis")
    .each(function(d) { d3.select(this).call(d3.svg.axis().scale(d.value.scale).orient("bottom")); })
  .append("text")
    .attr("x", width)
    .attr("y", 9)
    .attr("dy", ".72em")
    .style("text-anchor", "middle")
    .style("text-transform", "uppercase")
    .text(function(d) { return d.key; });

var canvas = channel.select("canvas")
    .call(d3.behavior.drag().on("drag", dragged))
    .each(render);

function dragged(d) {
  d.value.x = Math.max(0, Math.min(this.width - 1, d3.mouse(this)[0]));
  canvas.each(render);
}

function render(d) {
  var width = this.width,
      context = this.getContext("2d"),
      image = context.createImageData(width, 1),
      i = -1;

  var current = d3.hsl(
    channels.h.scale.invert(channels.h.x),
    channels.s.scale.invert(channels.s.x),
    channels.l.scale.invert(channels.l.x)
  );

  d3.select("#plop").style("background-color", "hsl(" + current.h + ", " + current.s * 100 + "% , " + current.l * 100 +"% )");

  for (var x = 0, v, c; x < width; ++x) {
    if (x === d.value.x) {
      c = white;
    } else if (x === d.value.x - 1) {
      c = black;
    } else {
      current[d.key] = d.value.scale.invert(x);
      c = d3.rgb(current);
    }
    image.data[++i] = c.r;
    image.data[++i] = c.g;
    image.data[++i] = c.b;
    image.data[++i] = 255;
  }
  context.putImageData(image, 0, 0);

}
</script>
 </body></html>