<!DOCTYPE html>
<html>
<head>
  <title>Aframe</title>
  <script src="../aframe/aframe.min.js"></script>
  <script src='../three/js/libs/inflate.min.js'></script>
  <script src="../three/build/three.js"></script>
  <script src="../three/js/controls/TrackballControls.js"></script>
  <script src="../three/js/loaders/VTKLoader.js"></script>
  <script src="../three/js/Detector.js"></script>
  <script src="../three/js/libs/stats.min.js"></script>  <meta charset="utf-8">
  <script src="../aframe/aframe-ar.js"></script>
  <script src="../js/jquery.min.js"></script>
  <script src="../js/d3.v3.min.js" charset="utf-8"></script>
  <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">

  <link rel="stylesheet" href="../bootstrap/css/bootstrap.min.css">
  <script src="../bootstrap/js/jquery-3.2.1.slim.min.js"></script>
  <script src="../bootstrap/js/popper.min.js"></script>
  <script src="../bootstrap/js/bootstrap.min.js"></script>

<style>
#a-scene {
  position: absolute;
}
#canvas {
  position: absolute;
  background-color:lightgrey
}
#button {
  position:absolute;
  left:0%;
  top:0%;
  z-index: 1;
}

.navbarrie {
  position:absolute;
  background-color: rgba(0,0,0,0.5);
  top:0%;
  z-index: 1;
}
.navbar-brand {
  color: rgba(255, 255, 255, 0.9) !important;
}
.dropdown-menu {
  background-color: rgba(0,0,0,0);
  color: rgba(255, 255, 255, 0.9) !important;
  border: 0px solid rgba(0,0,0,0.5);
  padding: 0;
}
.navbar {
  color:white;
}

</style>
</head>
<body>
<div class="col-md-12 navbarrie">
<nav class="navbar navbar-toggleable-md navbar-dark bg-faded">
  <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <a class="navbar-brand" href="#">Pierre</a>
  <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
    <div class="navbar-nav">
      <li class="nav-item dropdown">
        <a class="nav-link" onmouseover="" style="cursor: pointer;" onclick="backToDefault()">Default</a>
        <a class="nav-link dropdown-toggle" href="http://example.com" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          BodyParts
        </a>
        <div class="dropdown-menu col-md-8" aria-labelledby="navbarDropdownMenuLink">
          <table class="table">
            <tbody>
              <tr>
                <td onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('Skin')">Skin</td>
                <td onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('Blood')">Blood</td>
                <td onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('Brain')">Brain</td>
                <td onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('Duodenum')">Duodenum</td>
              </tr>
              <tr>
                <td onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('EyeRetina')">Eye Retina</td>
                <td onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('EyeWhite')">Eye White</td>
                <td onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('Heart')">Heart</td>
                <td onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('Ileum')">Ileum</td>
              </tr>
              <tr>
                <td onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('Kidney')">Kidney</td>
                <td onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('LargeIntestine')">Large Intestine</td>
                <td onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('Liver')">Liver</td>
                <td onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('Lung')">Lung</td>
              </tr>
              <tr>
                <td onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('Nerve')">Nerve</td>
                <td onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('Skeleton')">Skeleton</td>
                <td onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('Spleen')">Spleen</td>
                <td onmouseover="" style="cursor: pointer;" onclick="ChangeStuff('Stomach')">Stomach</td>
              </tr>
            </tbody>
          </table>
        </div>
      </li>
    </div>
  </div>
  </nav>
  </div>
  <a-scene embedded arjs="trackingMethod: best;">
    <a-anchor hit-testing-enabled='true'>
      <a-entity style="opacity:0.5;"></a-entity>
    </a-anchor>
    <a-camera-static/>
  </a-scene>

  <script>
    var meshesh = {};
    var color_codes = {"Skeleton" : 0xf0f0f0, "Stomach" : 0x858500};
    var organs = Object.keys(color_codes);
    var mesh;

    init();

    function init() {
      var scene = document.querySelector('a-entity').object3D;

      var beeybeey;
      var rot = { x: 90, y: 0, z: 0 };
      var scale = 0.002;

      var loader1 = new THREE.VTKLoader();
      loader1.load( '../vtkaas/pierre_t_s_d.vtk', function ( geometry ) {

        geometry.computeVertexNormals();
        geometry.center();
        beeybeey = geometry.boundingBox.min

        var material = new THREE.MeshLambertMaterial( { color: 0xf0f0f0, side: THREE.DoubleSide } );
        var mesh = new THREE.Mesh( geometry, material );
        meshesh["Skeleton"] = mesh;

        mesh.position.set( 0, 0, 0 );
        mesh.scale.multiplyScalar( scale );
        rotateObject( mesh, rot.x, rot.y , rot.z );

        scene.add( mesh );

        load_vtk('../vtkaas/pierre_t_s_d_stomach.vtk', scene, rot, scale, beeybeey, 0x858500, 1, "Stomach");

      });
    }

    function load_vtk(fileName, scene, rot, scale, beeybeey, color, opacity, index) {
      var loader = new THREE.VTKLoader();

      loader.load( fileName, function ( geometry ) {

        geometry.computeVertexNormals();
        geometry.translate(beeybeey.x, beeybeey.y, beeybeey.z)

        var material = new THREE.MeshLambertMaterial( { color: color, opacity: opacity, side: THREE.DoubleSide } );
        var mesh = new THREE.Mesh( geometry, material );
        meshesh[index] = mesh;

        mesh.position.set( 0, 0, 0 );
        mesh.scale.multiplyScalar( scale );
        rotateObject( mesh, rot.x, rot.y, rot.z );

        scene.add( mesh );
      })

      return beeybeey ;
    }

    function rotateObject(object,degreeX=0, degreeY=0, degreeZ=0) {
      degreeX = (degreeX * Math.PI) / 180;
      degreeY = (degreeY * Math.PI) / 180;
      degreeZ = (degreeZ * Math.PI) / 180;

      object.rotateX(degreeX);
      object.rotateY(degreeY);
      object.rotateZ(degreeZ);
    }

    function ChangeStuff(organ) {
      meshesh[organ].material.color = new THREE.Color(0xffffff * Math.random());
      meshesh[organ].material.opacity = Math.random()
      meshesh[organ].material.needsUpdate = true;
    }

    function backToDefault() {
      for (var i = organs.length - 1; i >= 0; i--) {
        meshesh[organs[i]].material.color = new THREE.Color(color_codes[organs[i]]);
        meshesh[organs[i]].material.needsUpdate = true;
      }
    }

  </script>
</body>
</html>
