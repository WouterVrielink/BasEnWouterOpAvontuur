<!DOCTYPE html>
<html>
<head>
  <title>Aframe</title>
  <script src="https://aframe.io/releases/0.7.0/aframe.min.js"></script>
  <script src='../three/js/libs/inflate.min.js'></script>
  <script src="../three/build/three.js"></script>
  <script src="../three/js/controls/TrackballControls.js"></script>
  <script src="../three/js/loaders/VTKLoader.js"></script>
  <script src="../three/js/Detector.js"></script>
  <script src="../three/js/libs/stats.min.js"></script>  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
</head>
<body>

  <script>
    AFRAME.registerComponent('pierre', {
      schema: {
        color: {
          default: '#000'
        },
      },

      update: function() {
        var material = new THREE.MeshBasicMaterial({
          color: this.data.color,
          wireframe: true
        });

        var geometry = new THREE.BoxGeometry(1, 1, 1);

        this.el.setObject3D('mesh', new THREE.Mesh(geometry, material));
      },

      remove: function() {
        this.el.removeObject3D('mesh');
      }
    });
  </script>

  <a-scene>
    <!-- <a-box color="#03A9F4" width="2" height="1" depth="1" position="0 0 0"></a-box>
    <a-entity mythreejsthing="color: green;" position="0 1 -5"> </a-entity> -->
    <a-entity pierre="color: green;" position="0 0 -7"> </a-entity>
  </a-scene>

  <script>

      // if ( ! Detector.webgl ) Detector.addGetWebGLMessage();

      var container, stats;

      var camera, controls, scene, renderer;

      var cross;

      init();
      // animate();

      function init() {

        scene = document.querySelector('a-scene').object3D;

        // light

        var material = new THREE.MeshLambertMaterial( { color: 0xffffff, side: THREE.DoubleSide } );

        var loader1 = new THREE.VTKLoader();
				loader1.load( '../vtkaas/pierre_t_s_d.vtk', function ( geometry ) {

					geometry.computeVertexNormals();
					geometry.center();

					var material = new THREE.MeshLambertMaterial( { color: 0x00ff00, side: THREE.DoubleSide } );
					var mesh = new THREE.Mesh( geometry, material );

					mesh.position.set( 0, 0, 0 );
					mesh.scale.multiplyScalar( 0.001 );


					scene.add( mesh );

				} );

				var loader3 = new THREE.VTKLoader();
				loader3.load( '../vtkaas/pierre_t_s_d_stomach.vtk', function ( geometry ) {

					geometry.computeVertexNormals();
					geometry.center();

					var material = new THREE.MeshLambertMaterial( { color: 0xff0000, side: THREE.DoubleSide } );
					var mesh = new THREE.Mesh( geometry, material );

					mesh.position.set( 0, 0, 0 );
					mesh.scale.multiplyScalar( 0.001 );


					scene.add( mesh );

				} );

      }

      function onWindowResize() {

        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();

        renderer.setSize( window.innerWidth, window.innerHeight );

        controls.handleResize();

      }

      function animate() {

        requestAnimationFrame( animate );

        controls.update();
        renderer.render( scene, camera );

        stats.update();

      }

    </script>
</body>
</html>
